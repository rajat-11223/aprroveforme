<div class="grid-x">
  <div class="large-3 large-offset-2 cell panel center">
    <h2><%= User.count %></h2>
    TOTAL USERS
  </div>
  <div class="large-3 large-offset-2 end cell panel center">
    <h2><%= Approval.count %></h2>
    TOTAL APPROVALS SENT
  </div>
</div>

<div class="grid-x">
  <div class="large-4 cell panel center">
    <h4><%= User.where('created_at >= ?', Date.today).count %></h4>
    DAILY NEW USERS
  </div>
  <div class="large-4 cell panel center">
    <h4><%= User.where('created_at >= ?', 1.week.ago).count %></h4>
    WEEKLY NEW USERS
  </div>
  <div class="large-4 cell panel center">
    <h4><%= User.where('created_at >= ?', 1.month.ago).count %></h4>
    MONTHLY NEW USERS
  </div>
</div>

<div class="grid-x">
  <div class="large-4 cell" style="margin-bottom:20px;">
    Export to
    <%= link_to "CSV", users_path(format: "csv") %>
  </div>
</div>

<div class="grid-x">
  <div class="auto cell">
    <table class="table">
      <thead>
        <tr>
          <th colspan="2"><%= sortable "name" %></th>
          <th><%= sortable "email" %></th>
          <th><%= sortable "created_at" %></th>
          <th><%= sortable "sent" %></th>
          <th><%= sortable "received" %></th>
          <th><%= sortable "updated_at", "last login" %></th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>

        <% @users.each do |user| %>
          <tr>
            <td><%= image_tag user.picture, :style=>"width:35px" %></td>
            <td><%= link_to user.name, user %></td>
            <td>
              <a href="mailto:<%= user.email %>" target="_blank"><%= user.email %></a>
            </td>
            <td><%= user.created_at.to_date %></td>
            <td><%= user.approvals.count %></td>
            <td><%= Approver.by_user(user).count %></td>
            <td><%= user.updated_at.to_date %></td>
            <td><%= link_to_if(user != current_user, "delete", user_path(user), data: { confirm: "Are you sure you want to delete '#{user.name}'?" },
                                                                                method: :delete,
                                                                                class: 'btn btn-mini') %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
    <%= paginate @users, :remote => true %>
  </div>
</div>
