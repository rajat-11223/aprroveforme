<% show_thank_you_blurb = !@approver.present? || !@approval.present? || @approval.past_due? || @approver.has_responded? %>

<% if show_thank_you_blurb %>
  <div class="row align-middle" style="min-height: 100vh">
    <div class="columns small-12">
      <div class="text-center">
        <h1 class="tw-text-5xl">Thank You</h1>
        <p>We have logged your response and have provided the requester your feedback</p>
      </div>
    </div>
  </div>
<% else %>
  <div class="tw-flex tw-px-32 tw-text-center">
    <div class="tw-flex-1">
      <h1>Please approve '<%= @approval.title %>'</h1>
    </div>
  </div>

  <div class="tw-flex tw-px-32">
    <div class="tw-w-full">
      <%= simple_format(@approval.description) %>
    </div>
  </div>

  <div class="tw-flex tw-mb-4 tw-text-center">
    <div class="tw-flex-1">
      <%= form_for @approver, url: response_path(@approver), remote: true do |f|  %>
        <%= f.hidden_field :code %>

        <div class="button-group round toggle text-center">
          <div class="tw-flex tw-flex-wrap tw-items-stretch tw-w-full">
            <div class="tw-w-1/3 tw-ml-auto">
              <%= f.label :status_approved, class: "tw-bg-green tw-hover:bg-green-dark tw-active:bg-blue-dark tw-text-white tw-font-bold tw-py-2 tw-px-4 tw-rounded" do %>
                <%= f.radio_button :status, 'approved', name: "status", required: true %>
                Approved
              <% end %>
            </div>
            <div class="tw-w-1/3 tw-mr-auto">
              <%= f.label :status_declined, class: "tw-bg-red tw-hover:bg-red-dark tw-active:bg-blue-dark tw-text-white tw-font-bold tw-py-2 tw-px-4 tw-rounded" do %>
                <%= f.radio_button :status, 'declined', name: "status", required: true %>
                Declined
              <% end %>
            </div>
          </div>
        </div>
        <%= f.text_area :comments, placeholder: "Please provide helpful feedback here", required: true, rows: 5, autocomplete: :off, class: "tw-shadow tw-appearance-none tw-border tw-rounded tw-w-full tw-py-2 tw-px-3 tw-text-grey-darker tw-mb-3 tw-leading-tight tw-focus:outline-none tw-focus:shadow-outline" %>
        <%= f.submit "Submit Response", class: "tw-bg-yellow-dark tw-hover:bg-yellow-darker tw-text-white tw-font-bold tw-py-2 tw-px-4 tw-rounded", data: { confirm: "Are you sure you want to submit your response? You will be unable to change it later."} %>
      <% end %>
    </div>
  </div>

  <div class="grid-x">
    <div class="cell small-12">
      <%= render partial: "shared/approval_preview", locals: { approval: @approval } %>
    </div>
  </div>
<% end %>
